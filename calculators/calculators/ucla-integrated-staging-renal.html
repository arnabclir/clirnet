<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UCLA Integrated Staging System - Renal Cell Carcinoma</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
        }

        body {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            padding-top: 20px;
            padding-bottom: 40px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .container { max-width: 800px; }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }

        .card-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border-radius: 15px 15px 0 0 !important;
            padding: 25px;
            border: none;
        }

        .card-header h3 {
            margin: 0;
            font-weight: 700;
            font-size: 24px;
        }

        .card-header small {
            display: block;
            margin-top: 8px;
            opacity: 0.95;
        }

        .card-body { padding: 30px; }

        .form-group { margin-bottom: 20px; }

        .form-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-control, .form-select {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 16px;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }

        .btn-calculate {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
            width: 100%;
        }

        .btn-calculate:hover {
            transform: translateY(-2px);
            color: white;
        }

        .btn-back {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .btn-back:hover {
            background: white;
            color: var(--primary-color);
        }

        .result-box {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-left: 4px solid var(--primary-color);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .result-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary-color);
            margin: 10px 0;
        }

        .interpretation {
            font-size: 16px;
            color: #333;
            margin-top: 10px;
            line-height: 1.6;
        }

        .formula-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #555;
        }

        .hidden { display: none; }

        .alert {
            border-radius: 8px;
            border: none;
        }

        .alert-info {
            background-color: rgba(102, 126, 234, 0.15);
            color: #333;
            border-left: 4px solid var(--primary-color);
        }

        .prognosis-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            margin-top: 10px;
            font-size: 14px;
        }

        .prognosis-favorable { background-color: #d4edda; color: #155724; }
        .prognosis-intermediate { background-color: #fff3cd; color: #856404; }
        .prognosis-unfavorable { background-color: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Back button navigation -->
        <a href="index.html" class="btn-back">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>

        <!-- Main calculator card -->
        <div class="card">
            <!-- Card header with title -->
            <div class="card-header">
                <h3><i class="fas fa-kidney"></i> UCLA UISS Score</h3>
                <small>UCLA Integrated Staging System - Renal Cell Carcinoma Prognosis</small>
            </div>

            <!-- Card body with form and results -->
            <div class="card-body">
                <!-- Information alert -->
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    <strong>Clinical Information:</strong> The UISS predicts cancer-specific survival in patients with renal cell carcinoma based on TNM stage, nuclear grade, and ECOG performance status.
                </div>

                <!-- Tumor characteristics -->
                <h5 class="mt-4 mb-3"><i class="fas fa-microscope"></i> Tumor Characteristics (TNM Stage)</h5>

                <!-- TNM Stage -->
                <div class="form-group">
                    <label for="uissTNM" class="form-label">
                        <i class="fas fa-flag"></i> TNM Stage
                    </label>
                    <select class="form-select" id="uissTNM">
                        <option value="">Select...</option>
                        <option value="I">Stage I (T1 N0 M0) - Tumor ≤7 cm</option>
                        <option value="II">Stage II (T2 N0 M0) - Tumor >7 cm</option>
                        <option value="III">Stage III (T3-T4 or N1 M0) - Extension</option>
                        <option value="IV">Stage IV (M1) - Metastatic disease</option>
                    </select>
                </div>

                <!-- Fuhrman Nuclear Grade -->
                <div class="form-group">
                    <label for="uissGrade" class="form-label">
                        <i class="fas fa-flask"></i> Fuhrman Nuclear Grade
                    </label>
                    <select class="form-select" id="uissGrade">
                        <option value="">Select...</option>
                        <option value="1">Grade 1 - Low (Favorable)</option>
                        <option value="2">Grade 2 - Low-Intermediate</option>
                        <option value="3">Grade 3 - Intermediate-High</option>
                        <option value="4">Grade 4 - High (Unfavorable)</option>
                    </select>
                </div>

                <!-- Performance status -->
                <h5 class="mt-4 mb-3"><i class="fas fa-heartbeat"></i> Clinical Status</h5>

                <!-- ECOG Performance Status -->
                <div class="form-group">
                    <label for="uissECOG" class="form-label">
                        <i class="fas fa-person"></i> ECOG Performance Status
                    </label>
                    <select class="form-select" id="uissECOG">
                        <option value="">Select...</option>
                        <option value="0">0 - Fully active, normal activities</option>
                        <option value="1">1 - Restricted but ambulatory</option>
                        <option value="2">2 - In bed >50% of time</option>
                        <option value="3">3 - Bedbound</option>
                        <option value="4">4 - Completely disabled</option>
                    </select>
                </div>

                <!-- Calculate button -->
                <button class="btn btn-calculate" onclick="calculateUIIS()">
                    <i class="fas fa-calculator"></i> Calculate UISS Score & Prognosis
                </button>

                <!-- Results section -->
                <div id="results" class="hidden">
                    <div class="result-box">
                        <strong style="font-size: 18px;"><i class="fas fa-chart-pie"></i> Prognosis Assessment</strong>

                        <!-- UISS Risk Group -->
                        <div>
                            <h5 style="margin-top: 15px; color: #333;">UISS Risk Group</h5>
                            <div class="result-value" id="uissGroup">-</div>
                        </div>

                        <!-- 5-year cancer-specific survival -->
                        <div style="margin-top: 15px;">
                            <h5 style="color: #333;">5-Year Cancer-Specific Survival</h5>
                            <div class="result-value" id="survival5yr" style="font-size: 28px;">-</div>
                        </div>

                        <!-- Prognosis interpretation -->
                        <div class="interpretation" id="uissInterpretation" style="margin-top: 15px;"></div>

                        <!-- Prognosis badge -->
                        <div id="prognosisBadge"></div>

                        <!-- Recommendations section -->
                        <div style="margin-top: 20px; background-color: #f0f8ff; padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                            <strong><i class="fas fa-stethoscope"></i> Clinical Management Recommendations:</strong>
                            <ul style="margin-bottom: 0; margin-top: 10px; font-size: 14px;">
                                <li id="rec1"></li>
                                <li id="rec2"></li>
                                <li id="rec3"></li>
                            </ul>
                        </div>

                        <!-- Formula and methodology -->
                        <div class="formula-box">
                            <strong>Model Details:</strong><br>
                            - University of California, Los Angeles (UCLA) Integrated Staging System<br>
                            - Combines TNM stage, Fuhrman nuclear grade, and ECOG performance status<br>
                            - Three risk groups: Favorable, Intermediate, Unfavorable<br>
                            - Predicts cancer-specific mortality<br>
                            - Used for prognostication and treatment planning in RCC<br>
                            - Superior to TNM stage alone for outcome prediction
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // UISS calculation
        function calculateUIIS() {
            // Input validation
            const tnmStage = document.getElementById('uissTNM').value;
            const grade = parseInt(document.getElementById('uissGrade').value);
            const ecog = parseInt(document.getElementById('uissECOG').value);

            // Validate required fields
            if (!tnmStage || isNaN(grade) || isNaN(ecog)) {
                alert('Please fill in all required fields');
                return;
            }

            // Determine risk group based on UISS criteria
            let riskGroup = '';
            let survival5yr = 0;

            // Favorable: Stage I or II, Grade 1-2, ECOG 0
            if ((tnmStage === 'I' || tnmStage === 'II') && grade <= 2 && ecog === 0) {
                riskGroup = 'Favorable';
                survival5yr = 90;
            }
            // Unfavorable: Stage IV, Grade 4, or ECOG 2-4
            else if (tnmStage === 'IV' || grade === 4 || ecog >= 2) {
                riskGroup = 'Unfavorable';
                survival5yr = 20;
            }
            // Intermediate: Everything else
            else {
                riskGroup = 'Intermediate';
                if (tnmStage === 'III') survival5yr = 60;
                else if (grade === 3) survival5yr = 55;
                else survival5yr = 70;
            }

            // Display results
            document.getElementById('uissGroup').textContent = riskGroup;
            document.getElementById('survival5yr').textContent = survival5yr + '%';

            // Interpretation
            let interpretation = '';
            let prognosisClass = '';
            let recommendations = [];

            if (riskGroup === 'Favorable') {
                interpretation = 'Favorable prognosis: High 5-year cancer-specific survival (≥90%). Excellent outcomes expected with appropriate treatment.';
                prognosisClass = 'prognosis-favorable';
                recommendations = [
                    'Radical nephrectomy is standard treatment',
                    'Surveillance with imaging every 3-6 months for first 2 years',
                    'Adjuvant therapy generally not recommended'
                ];
            } else if (riskGroup === 'Intermediate') {
                interpretation = 'Intermediate prognosis: Moderate 5-year cancer-specific survival (50-75%). Close follow-up and consideration of adjuvant therapy recommended.';
                prognosisClass = 'prognosis-intermediate';
                recommendations = [
                    'Radical nephrectomy with careful staging',
                    'Consider adjuvant immune checkpoint inhibitor therapy',
                    'Regular surveillance imaging (every 3-4 months initially)'
                ];
            } else {
                interpretation = 'Unfavorable prognosis: Low 5-year cancer-specific survival (<30%). Aggressive treatment and surveillance recommended.';
                prognosisClass = 'prognosis-unfavorable';
                recommendations = [
                    'Systemic therapy with checkpoint inhibitors or tyrosine kinase inhibitors',
                    'Cytoreductive nephrectomy may be considered',
                    'Palliative care integration for metastatic disease'
                ];
            }

            document.getElementById('uissInterpretation').textContent = interpretation;

            // Add badge
            const badgeText = riskGroup === 'Favorable' ? 'FAVORABLE' : riskGroup === 'Intermediate' ? 'INTERMEDIATE' : 'UNFAVORABLE';
            document.getElementById('prognosisBadge').innerHTML = `<span class="prognosis-badge ${prognosisClass}">${badgeText}</span>`;

            // Display recommendations
            recommendations.forEach((rec, index) => {
                document.getElementById(`rec${index + 1}`).textContent = rec;
            });

            // Show results
            document.getElementById('results').classList.remove('hidden');
        }
    </script>
</body>
</html>
